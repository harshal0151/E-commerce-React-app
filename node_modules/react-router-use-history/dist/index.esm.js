import t,{createContext as e,useRef as n,useState as r,useLayoutEffect as o,useContext as a}from"react";import{Router as i,UNSAFE_NavigationContext as c,UNSAFE_DataRouterContext as l}from"react-router-dom";import{useSyncExternalStore as u}from"use-sync-external-store/shim";function s(){return s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s.apply(this,arguments)}var h,f;function p(t){return{usr:t.state,key:t.key}}function d(t,e,n,r){return void 0===n&&(n=null),s({pathname:"string"==typeof t?t:t.pathname,search:"",hash:""},"string"==typeof e?function(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}(e):e,{state:n,key:(null==e?void 0:e.key)||r||Math.random().toString(36).substr(2,8)})}!function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"}(h||(h={})),function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"}(f||(f={}));const v=e(null);function m({basename:e,children:a,window:c,history:l}){const u=n(new Set);let s=n();var f;null==s.current&&(s.current=l||(void 0===(f={window:c,v5Compat:!0})&&(f={}),function(t,e,n,r){void 0===r&&(r={});let{window:o=document.defaultView,v5Compat:a=!1}=r,i=o.history,c=h.Pop,l=null;function u(){c=h.Pop,l&&l({action:c,location:s.location})}let s={get action(){return c},get location(){return function(t,e){var n,r;let{pathname:o,search:a,hash:i}=t.location;return d("",{pathname:o,search:a,hash:i},(null==(n=e.state)?void 0:n.usr)||null,(null==(r=e.state)?void 0:r.key)||"default")}(o,i)},listen(t){if(l)throw new Error("A history only accepts one active listener");return o.addEventListener("popstate",u),l=t,()=>{o.removeEventListener("popstate",u),l=null}},createHref:t=>function(t,e){return"string"==typeof e?e:function(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&"?"!==n&&(e+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(e+="#"===r.charAt(0)?r:"#"+r),e}(e)}(0,t),push:function(t,e){c=h.Push;let n=d(s.location,t,e),r=p(n),u=s.createHref(n);try{i.pushState(r,"",u)}catch(t){o.location.assign(u)}a&&l&&l({action:c,location:n})},replace:function(t,e){c=h.Replace;let n=d(s.location,t,e),r=p(n),o=s.createHref(n);i.replaceState(r,"",o),a&&l&&l({action:c,location:n})},go:t=>i.go(t)};return s}(0,0,0,f)));let m=s.current,[y,g]=r({action:m.action,location:m.location});return o(()=>m.listen(t=>{u.current.forEach(e=>e(t)),g(t)}),[m]),t.createElement(v.Provider,{value:{ref:u}},t.createElement(i,{basename:e,children:a,location:y.location,navigationType:y.action,navigator:m}))}function y(){return y=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},y.apply(this,arguments)}const g=()=>{const t=a(c).navigator,e=a(v);return y({},t,{listen:t=>(null==e||e.ref.current.add(t),()=>{null==e||e.ref.current.delete(t)})})},b=()=>{const t=l&&a(l);if(t){var e,n;const r=null==t||null==(e=t.router)?void 0:e.state;return y({get location(){return null==r?void 0:r.location},get action(){return null==r?void 0:r.historyAction},listen:null==t||null==(n=t.router)?void 0:n.subscribe},null==t?void 0:t.navigator)}return g()},w=t=>{const e=b();return u(e.listen,()=>t(e))};export{m as BrowserRouter,v as UNSAFE_SubscriptionContext,g as useBrowserRouterHistory,b as useHistory,w as useHistorySelector};
//# sourceMappingURL=index.esm.mjs.map
